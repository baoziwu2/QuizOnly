# Coai-Main ä¸ Quiznote-Main é¡¹ç›®åˆå¹¶æ€»ç»“

## é¡¹ç›®æ¦‚è¿°

æœ¬æ¬¡ä»»åŠ¡æˆåŠŸå°† **quiznote-main** (Next.jsåº”ç”¨) çš„æµ‹éªŒç”ŸæˆåŠŸèƒ½é›†æˆåˆ° **coai-main** (Chat Nio AIèŠå¤©å¹³å°) ä¸­ã€‚åˆå¹¶éµå¾ªäº†ä»¥ä¸‹åŸåˆ™ï¼š

1. âœ… åœ¨coaiåŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹
2. âœ… éµå¾ªcoaiçš„ä¾èµ–å’Œæ¶æ„
3. âœ… åªæ·»åŠ ä¾èµ–ï¼Œä¸ä¿®æ”¹ç°æœ‰ä¾èµ–
4. âœ… ä¿è¯ä»£ç å¯ç»´æŠ¤æ€§

## æŠ€æœ¯æ ˆå¯¹æ¯”

### åŸé¡¹ç›®

**Quiznote-main**:
- æ¡†æ¶: Next.js 14 (React 18)
- AI API: Google Vertex AI (Gemini)
- çŠ¶æ€ç®¡ç†: Zustand
- æ ·å¼: Tailwind CSS
- éƒ¨ç½²: Vercel

**Coai-main**:
- åç«¯: Go 1.20 + Gin
- å‰ç«¯: React 18 + Vite
- çŠ¶æ€ç®¡ç†: Redux Toolkit  
- æ ·å¼: Less + Shadcn UI
- éƒ¨ç½²: Docker

### åˆå¹¶å

ä¿æŒcoaiçš„æŠ€æœ¯æ ˆï¼Œå°†quiznoteçš„åŠŸèƒ½é€‚é…ï¼š
- åç«¯: Go + Gin (æ–°å¢quizæ¨¡å—)
- å‰ç«¯: React + Vite (ç§»æ¤ç»„ä»¶)
- çŠ¶æ€ç®¡ç†: Redux (æ›¿ä»£Zustand)
- AIé›†æˆ: ä½¿ç”¨coaiç°æœ‰çš„æ¨¡å‹ç®¡ç†ç³»ç»Ÿ
- æ ·å¼: Less (é€‚é…quiznoteæ ·å¼)

## æ¶æ„è®¾è®¡

### åç«¯æ¶æ„

```
coai-main/
â”œâ”€â”€ quiz/                    # æ–°å¢Quizæ¨¡å—
â”‚   â”œâ”€â”€ types.go            # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ controller.go       # ä¸šåŠ¡é€»è¾‘å’ŒAPIå¤„ç†
â”‚   â””â”€â”€ router.go           # è·¯ç”±æ³¨å†Œ
â””â”€â”€ main.go                 # ä¸»å…¥å£ï¼ˆå·²æ³¨å†Œquizæ¨¡å—ï¼‰
```

**æ ¸å¿ƒåŠŸèƒ½**:
1. WebSocketç«¯ç‚¹å¤„ç†å®æ—¶ç”Ÿæˆ
2. åˆ©ç”¨coaiç°æœ‰çš„AIæ¨¡å‹ç®¡ç†å™¨
3. é›†æˆè®¤è¯å’Œé…é¢ç³»ç»Ÿ
4. æ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œè§£æ

### å‰ç«¯æ¶æ„

```
coai-main/app/src/
â”œâ”€â”€ routes/quiz/
â”‚   â””â”€â”€ index.tsx           # Quizä¸»é¡µé¢
â”œâ”€â”€ components/quiz/        # Quizç»„ä»¶åº“
â”‚   â”œâ”€â”€ QuizForm.tsx        # è¡¨å•ç»„ä»¶
â”‚   â”œâ”€â”€ QuizLoading.tsx     # åŠ è½½çŠ¶æ€
â”‚   â”œâ”€â”€ QuizContainer.tsx   # ç­”é¢˜ç•Œé¢
â”‚   â””â”€â”€ QuizSummary.tsx     # ç»“æœæ±‡æ€»
â”œâ”€â”€ store/
â”‚   â””â”€â”€ quiz.ts             # ReduxçŠ¶æ€ç®¡ç†
â”œâ”€â”€ api/
â”‚   â””â”€â”€ quiz.ts             # WebSocket APIå®¢æˆ·ç«¯
â”œâ”€â”€ types/
â”‚   â””â”€â”€ quiz.ts             # TypeScriptç±»å‹
â””â”€â”€ assets/pages/
    â””â”€â”€ quiz.less           # æ ·å¼æ–‡ä»¶
```

**æ ¸å¿ƒåŠŸèƒ½**:
1. è¡¨å•è¾“å…¥ï¼ˆç¬”è®°/æ–‡ä»¶/å‚æ•°ï¼‰
2. å®æ—¶æµå¼ç”Ÿæˆ
3. äº¤äº’å¼ç­”é¢˜
4. ç»“æœç»Ÿè®¡å’Œåé¦ˆ

## ä¸»è¦ä¿®æ”¹ç‚¹

### 1. åç«¯æ–°å¢ (coai-main)

âœ… **æ–°å¢æ–‡ä»¶**:
- `quiz/types.go` - æ•°æ®ç»“æ„å®šä¹‰
- `quiz/controller.go` - ä¸šåŠ¡é€»è¾‘å®ç°
- `quiz/router.go` - è·¯ç”±é…ç½®

âœ… **ä¿®æ”¹æ–‡ä»¶**:
- `main.go` - æ·»åŠ quizåŒ…å¯¼å…¥å’Œè·¯ç”±æ³¨å†Œ

### 2. å‰ç«¯é›†æˆ (coai-main/app)

âœ… **æ–°å¢æ–‡ä»¶**:
- `src/routes/quiz/index.tsx` - Quizä¸»é¡µé¢
- `src/components/quiz/*.tsx` - Quizç»„ä»¶
- `src/store/quiz.ts` - ReduxçŠ¶æ€ç®¡ç†
- `src/api/quiz.ts` - APIå®¢æˆ·ç«¯
- `src/types/quiz.ts` - ç±»å‹å®šä¹‰
- `src/assets/pages/quiz.less` - æ ·å¼

âœ… **ä¿®æ”¹æ–‡ä»¶**:
- `src/router.tsx` - æ·»åŠ /quizè·¯ç”±
- `src/store/index.ts` - æ³¨å†Œquiz reducer
- `src/resources/i18n/en.json` - è‹±æ–‡ç¿»è¯‘
- `src/resources/i18n/cn.json` - ä¸­æ–‡ç¿»è¯‘

### 3. é›†æˆç‚¹

#### è®¤è¯ç³»ç»Ÿ
```go
user := auth.ParseToken(c, form.Token)
if !auth.HitGroups(db, user, QuizPermissionGroup) {
    // æƒé™æ£€æŸ¥
}
```

#### AIæ¨¡å‹ç®¡ç†
```go
channel := manager.NewChatManager(form.Model)
buffer := utils.NewBuffer(form.Model, messages, manager.GenerateMaxMessages)
```

#### é…é¢ç³»ç»Ÿ
```go
quota := channel.GetQuota(buffer, plan)
auth.DeductQuotaWithSubscription(db, cache, user, quota, plan)
```

#### UIç»„ä»¶å¤ç”¨
```tsx
import { Button } from "@/components/ui/button.tsx";
import { Input } from "@/components/ui/input.tsx";
import { Select, SelectContent, SelectItem } from "@/components/ui/select.tsx";
```

## æ•°æ®æµè®¾è®¡

### Quizç”Ÿæˆæµç¨‹

```
ç”¨æˆ·è¾“å…¥
    â†“
å‰ç«¯è¡¨å•éªŒè¯
    â†“
WebSocketè¿æ¥å»ºç«‹
    â†“
å‘é€QuizGenerationRequest
    â†“
åç«¯æƒé™éªŒè¯
    â†“
æ„å»ºAIæç¤ºè¯
    â†“
è°ƒç”¨AIæ¨¡å‹ï¼ˆæµå¼ï¼‰
    â†“
å®æ—¶è¿”å›ç”Ÿæˆå†…å®¹
    â†“
è§£æJSONæ ¼å¼
    â†“
å‰ç«¯å±•ç¤ºQuiz
    â†“
ç”¨æˆ·ç­”é¢˜
    â†“
è®¡ç®—å¾—åˆ†
    â†“
å±•ç¤ºç»“æœ
```

### çŠ¶æ€ç®¡ç†

ä½¿ç”¨Reduxç®¡ç†QuizçŠ¶æ€ï¼š

```typescript
interface QuizState {
  quizzes: Quiz[];          // é¢˜ç›®åˆ—è¡¨
  index: number;            // å½“å‰é¢˜ç›®ç´¢å¼•
  selectedAnswer: string;   // é€‰ä¸­ç­”æ¡ˆ
  points: number;           // å•é¢˜åˆ†æ•°
  totalPoints: number;      // æ€»åˆ†
  status: QuizStatus;       // æµç¨‹çŠ¶æ€
  streamContent: string;    // æµå¼å†…å®¹ç¼“å­˜
}
```

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

1. âœ… **æ™ºèƒ½æµ‹éªŒç”Ÿæˆ**
   - åŸºäºç¬”è®°æ–‡æœ¬ç”Ÿæˆ
   - æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼ˆPDFã€DOCXã€å›¾ç‰‡ç­‰ï¼‰
   - è‡ªå®šä¹‰éš¾åº¦çº§åˆ«
   - çµæ´»è®¾ç½®é¢˜ç›®æ•°é‡

2. âœ… **äº¤äº’å¼ç­”é¢˜**
   - å®æ—¶è¿›åº¦æ˜¾ç¤º
   - å•é€‰é¢˜å½¢å¼
   - ç­”æ¡ˆéªŒè¯
   - å³æ—¶è®¡åˆ†

3. âœ… **ç»“æœåˆ†æ**
   - æ€»åˆ†è®¡ç®—
   - æ­£ç¡®ç‡ç»Ÿè®¡
   - æˆç»©è¯„ä»·
   - é‡æ–°æµ‹éªŒ

### æŠ€æœ¯ç‰¹æ€§

1. âœ… **å®æ—¶ç”Ÿæˆ**
   - WebSocketæµå¼ä¼ è¾“
   - å®æ—¶å†…å®¹æ›´æ–°
   - è¿›åº¦æç¤º

2. âœ… **æƒé™æ§åˆ¶**
   - ç”¨æˆ·è®¤è¯
   - æƒé™ç»„æ£€æŸ¥
   - é…é¢ç®¡ç†

3. âœ… **å¤šè¯­è¨€æ”¯æŒ**
   - ä¸­æ–‡ç•Œé¢
   - è‹±æ–‡ç•Œé¢
   - æ˜“äºæ‰©å±•

4. âœ… **å“åº”å¼è®¾è®¡**
   - PCç«¯é€‚é…
   - ç§»åŠ¨ç«¯é€‚é…
   - å¹³æ¿é€‚é…

## ä»£ç è´¨é‡ä¿è¯

### 1. æ¨¡å—åŒ–è®¾è®¡

- å‰åç«¯åˆ†ç¦»
- ç»„ä»¶åŒ–å¼€å‘
- åŠŸèƒ½è§£è€¦

### 2. ç±»å‹å®‰å…¨

- Goå¼ºç±»å‹æ£€æŸ¥
- TypeScriptç±»å‹å®šä¹‰
- Reduxç±»å‹æ¨å¯¼

### 3. é”™è¯¯å¤„ç†

```go
// åç«¯é”™è¯¯å¤„ç†
if err != nil {
    conn.Send(QuizGenerationResponse{
        Message: fmt.Sprintf("failed: %s", err.Error()),
        Error:   err.Error(),
        End:     true,
    })
    return
}
```

```typescript
// å‰ç«¯é”™è¯¯å¤„ç†
try {
  const quizzes = JSON.parse(data);
  dispatch(setQuizzes(quizzes));
} catch (err) {
  console.error("Error parsing quiz data:", err);
  setError(t("quiz.parse-error"));
  dispatch(reset());
}
```

### 4. ä»£ç æ³¨é‡Š

æ‰€æœ‰å…³é”®å‡½æ•°å’Œå¤æ‚é€»è¾‘éƒ½æ·»åŠ äº†æ³¨é‡Šè¯´æ˜ã€‚

## ä¾èµ–ç®¡ç†

### åç«¯ (Go)

**æœªæ·»åŠ æ–°ä¾èµ–** - å®Œå…¨ä½¿ç”¨coaiç°æœ‰ä¾èµ–ï¼š
- `github.com/gin-gonic/gin` - Webæ¡†æ¶
- `github.com/gorilla/websocket` - WebSocket
- å…¶ä»–coaiå†…éƒ¨åŒ…

### å‰ç«¯ (TypeScript/React)

**æœªæ·»åŠ æ–°ä¾èµ–** - å®Œå…¨ä½¿ç”¨coaiç°æœ‰ä¾èµ–ï¼š
- `react` & `react-dom`
- `react-redux` & `@reduxjs/toolkit`
- `react-i18next`
- Shadcn UIç»„ä»¶
- å…¶ä»–coaiå†…éƒ¨å·¥å…·

## éƒ¨ç½²è¯´æ˜

### å¼€å‘ç¯å¢ƒ

```bash
# åç«¯
cd coai-main
go mod tidy
go run main.go

# å‰ç«¯
cd coai-main/app
npm install
npm run dev
```

### ç”Ÿäº§ç¯å¢ƒ

ä½¿ç”¨coaiç°æœ‰çš„Dockeréƒ¨ç½²æ–¹å¼ï¼š

```bash
cd coai-main
docker-compose up -d
```

QuizåŠŸèƒ½ä¼šè‡ªåŠ¨åŒ…å«åœ¨éƒ¨ç½²ä¸­ã€‚

## é…ç½®è¯´æ˜

### åç«¯é…ç½®

æ— éœ€é¢å¤–é…ç½®ï¼Œä½¿ç”¨coaiç°æœ‰é…ç½®ï¼š
- æ•°æ®åº“é…ç½®
- Redisé…ç½®
- æ¨¡å‹é…ç½®

### æƒé™é…ç½®

ç®¡ç†å‘˜éœ€è¦åœ¨åå°è®¾ç½® `quiz` æƒé™ç»„ï¼š

1. ç™»å½•ç®¡ç†åå°
2. è¿›å…¥ç”¨æˆ·ç»„ç®¡ç†
3. ä¸ºç›®æ ‡ç”¨æˆ·ç»„å¯ç”¨ `quiz` æƒé™

## æµ‹è¯•å»ºè®®

### åŠŸèƒ½æµ‹è¯•

1. **ç”Ÿæˆæµ‹è¯•**
   - [ ] ä»æ–‡æœ¬ç”Ÿæˆæµ‹éªŒ
   - [ ] ä»PDFæ–‡ä»¶ç”Ÿæˆ
   - [ ] ä»å›¾ç‰‡æ–‡ä»¶ç”Ÿæˆ
   - [ ] ä¸åŒéš¾åº¦çº§åˆ«
   - [ ] ä¸åŒé¢˜ç›®æ•°é‡

2. **ç­”é¢˜æµ‹è¯•**
   - [ ] é€‰æ‹©ç­”æ¡ˆ
   - [ ] åˆ‡æ¢é¢˜ç›®
   - [ ] å®Œæˆæµ‹éªŒ
   - [ ] æŸ¥çœ‹ç»“æœ

3. **è¾¹ç•Œæµ‹è¯•**
   - [ ] æœªç™»å½•è®¿é—®
   - [ ] æ— æƒé™è®¿é—®
   - [ ] é…é¢ä¸è¶³
   - [ ] ç½‘ç»œä¸­æ–­
   - [ ] æ— æ•ˆè¾“å…¥

### æ€§èƒ½æµ‹è¯•

1. **å¹¶å‘æµ‹è¯•**
   - å¤šç”¨æˆ·åŒæ—¶ç”Ÿæˆ
   - WebSocketè¿æ¥æ•°

2. **å“åº”æ—¶é—´**
   - ç”Ÿæˆæ—¶é—´
   - é¡µé¢åŠ è½½æ—¶é—´

## ç»´æŠ¤æŒ‡å—

### ä»£ç ç»´æŠ¤

1. **åç«¯**
   - ä½ç½®: `coai-main/quiz/`
   - éµå¾ªGoä»£ç è§„èŒƒ
   - ä¿æŒä¸coaiæ¶æ„ä¸€è‡´

2. **å‰ç«¯**
   - ä½ç½®: `coai-main/app/src/`
   - éµå¾ªReact/TypeScriptè§„èŒƒ
   - ä½¿ç”¨Reduxç®¡ç†çŠ¶æ€

### åŠŸèƒ½æ‰©å±•

å¯ä»¥æ‰©å±•çš„æ–¹å‘ï¼š
1. æ›´å¤šé¢˜å‹ï¼ˆå¤šé€‰ã€å¡«ç©ºã€åˆ¤æ–­ï¼‰
2. é¢˜åº“ç®¡ç†
3. å­¦ä¹ è¿›åº¦è·Ÿè¸ª
4. ç¤¾äº¤åˆ†äº«
5. åä½œå­¦ä¹ 

### é—®é¢˜æ’æŸ¥

1. **ç”Ÿæˆå¤±è´¥**
   - æ£€æŸ¥AIæ¨¡å‹é…ç½®
   - æ£€æŸ¥æƒé™è®¾ç½®
   - æŸ¥çœ‹åç«¯æ—¥å¿—

2. **æ˜¾ç¤ºå¼‚å¸¸**
   - æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°
   - éªŒè¯æ•°æ®æ ¼å¼
   - æ£€æŸ¥æ ·å¼æ–‡ä»¶

## æ–‡æ¡£èµ„æº

- ğŸ“– [Quizé›†æˆæ–‡æ¡£](./QUIZ_INTEGRATION.md) - è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
- ğŸ“– [Coaiä¸»æ–‡æ¡£](./README.md) - Coaiå¹³å°æ–‡æ¡£
- ğŸ“– [APIæ–‡æ¡£](./docs/api.md) - APIæ¥å£æ–‡æ¡£

## æˆæœæ€»ç»“

### å®Œæˆçš„å·¥ä½œ

âœ… 1. **åç«¯é›†æˆ** - å®Œæ•´çš„Quizæ¨¡å—
âœ… 2. **å‰ç«¯å¼€å‘** - å®Œæ•´çš„UIç»„ä»¶
âœ… 3. **çŠ¶æ€ç®¡ç†** - Reduxé›†æˆ
âœ… 4. **è·¯ç”±é…ç½®** - é¡µé¢è·¯ç”±
âœ… 5. **å›½é™…åŒ–** - ä¸­è‹±æ–‡ç¿»è¯‘
âœ… 6. **æ ·å¼é€‚é…** - å“åº”å¼è®¾è®¡
âœ… 7. **æ–‡æ¡£ç¼–å†™** - æŠ€æœ¯æ–‡æ¡£

### ä»£ç ç»Ÿè®¡

```
æ–°å¢æ–‡ä»¶: 14ä¸ª
ä¿®æ”¹æ–‡ä»¶: 5ä¸ª
æ–°å¢ä»£ç è¡Œæ•°: ~2000è¡Œ
- Goä»£ç : ~500è¡Œ
- TypeScript/TSX: ~1200è¡Œ
- Lessæ ·å¼: ~300è¡Œ
```

### ä¿æŒçš„åŸåˆ™

âœ… ä¸ä¿®æ”¹coaiç°æœ‰ä¾èµ–
âœ… éµå¾ªcoaiä»£ç é£æ ¼
âœ… å¤ç”¨coaiåŸºç¡€è®¾æ–½
âœ… ä¿æŒä»£ç å¯ç»´æŠ¤æ€§
âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
âœ… è¯¦ç»†çš„ä»£ç æ³¨é‡Š
âœ… å®Œå–„çš„æ–‡æ¡£è¯´æ˜

## åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸ (1-2å‘¨)

1. æ·»åŠ å•å…ƒæµ‹è¯•
2. æ€§èƒ½ä¼˜åŒ–
3. ç”¨æˆ·åé¦ˆæ”¶é›†

### ä¸­æœŸ (1-2æœˆ)

1. é¢˜åº“ç®¡ç†åŠŸèƒ½
2. å­¦ä¹ è¿›åº¦è·Ÿè¸ª
3. æ›´å¤šé¢˜å‹æ”¯æŒ

### é•¿æœŸ (3-6æœˆ)

1. AIè‡ªé€‚åº”éš¾åº¦
2. åä½œå­¦ä¹ åŠŸèƒ½
3. ç§»åŠ¨ç«¯APP

## è”ç³»æ–¹å¼

- æŠ€æœ¯æ”¯æŒ: support@chatnio.com
- é—®é¢˜åé¦ˆ: GitHub Issues
- åŠŸèƒ½å»ºè®®: Feature Requests

---

**åˆå¹¶å®Œæˆæ—¶é—´**: 2025å¹´10æœˆ5æ—¥
**é¡¹ç›®ç‰ˆæœ¬**: v1.0.0
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
